<!DOCTYPE html>
<html lang="en" style="-webkit-app-region: drag;">
<head>
    <meta charset="UTF-8">
    <title>KeyViewer</title>
</head>
<body style="background: #000;color: #fff">
<div id="asdf"></div>
asdf
<script>
    const _ = require('lodash')
    const config = require('../config.json')
    const keys = config.keys
    const asdf = document.querySelector('#asdf')
    const active = []

    'use strict';

    const ioHook = require('iohook');

    function update() {
        asdf.innerHTML = active.map(r=>keys.find(x=>x.key===r).label).join(', ')
    }

    ioHook.on('keydown', event => {
        if (keys.find(r=>r.key === event.keycode)) {
            if (!active.find(r=>r===event.keycode)) {
                active.push(event.keycode)
            }
        }
        update()
    })
    ioHook.on('keyup', event => {
        if (keys.find(r=>r.key === event.keycode)) {
            if (active.find(r=>r===event.keycode)) {
                _.remove(active, (i) => i === event.keycode)
            }
        }
        update()
    })

    ioHook.start();
</script>
</body>
</html>
