<!DOCTYPE html>
<html lang="en" style="-webkit-app-region: drag;">
<head>
    <meta charset="UTF-8">
    <title>KeyViewer</title>
    <link rel="stylesheet" href="./style.css">
</head>
<body>
<div id="root"></div>
<script>
    const _ = require('lodash')
    const config = require('../config.json')
    const keys = config.keys
    const active = []

    for (const key of keys) {
        const elem = document.createElement('div')
        elem.classList.add('key')
        elem.innerText = key.label
        document.querySelector('#root').append(elem)
    }

    const ioHook = require('iohook');

    function update() {
        //asdf.innerHTML = active.map(r=>keys.find(x=>x.key===r).label).join(', ')
    }

    ioHook.on('keydown', event => {
        if (keys.find(r=>r.key === event.keycode)) {
            if (!active.find(r=>r===event.keycode)) {
                active.push(event.keycode)
            }
        }
        update()
    })
    ioHook.on('keyup', event => {
        if (keys.find(r=>r.key === event.keycode)) {
            if (active.find(r=>r===event.keycode)) {
                _.remove(active, (i) => i === event.keycode)
            }
        }
        update()
    })

    ioHook.start();
</script>
</body>
</html>
